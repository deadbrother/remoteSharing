/*
 * 活动框架smartWizard的js控制
 * 
 * 
 */
var action;

$(function() {
	$("#submitbutton").bind(
			'click',
			function yyf() {
				var userPhone = $('#userPhone').val();
				var desc = $('#desc').val();
				var filteType = $("#filteType").val();
				// 1(3[4-9]|4[7]|5[0-27-9]|7[08]|8[2-478])\\d{8}$
				// ^1[3|4|5|7|8]\d{9}$
				var phoneNum = /^1[3|4|5|7|8]\d{9}$/;
				if (!phoneNum.test(userPhone)) {
					alert("请输入正确的手机号");

				}
				if (desc == null || desc.length == 0 || desc == "") {
					alert("请输入描述信息");

				}
				/*
				 * if(filteType!="黑名单" && filteType!="白名单") { alert("请选择用户类型");
				 *  }
				 */
				if (!confirm('确认提交？'))

				var userId = $("#userId").val();
				var logUserPhone = $('#logUserPhone').val();
				var logDesc = $('#logDesc').val();
				var logFilteType = $('#logFilteType').val();
				var logOperator = $('#logOperator').val();
				var logOperateTime = $('#logOperateTime').val();
				if (userId != null && userId.length != 0) {
					var str = "activity-filte!modify?bo.userId=" + userId
							+ "&bo.userPhone=" + userPhone + "&bo.desc=" + desc
							+ "&bo.filteType=" + filteType
							+ "&logBo.userPhone=" + logUserPhone + ","
							+ logOperateTime + "&logBo.desc=" + logDesc
							+ "&logBo.filteType=" + logFilteType
							+ "&logBo.operator=" + logOperator;
					action = "../filte/toModify";
					$.ajax({
						url : action,
						type : "POST",
						async : true,
						data : {
							"userId" : userId,
							"userPhone" : userPhone,
							"filteType" : filteType,
							"logOperateTime" : logOperateTime,
							"logDesc" : logDesc,
							"logOperator" : logOperator
						},
						success : function(data) {
							if (data == "success") {
								parent.hideMenu();
								parent.closeTypelayer();
							} else {
								alert("操作失败");
							}
						}
					});
				} else {
					action = "../filte/add";
					$.ajax({
						url : action,
						type : "POST",
						async : true,
						data : {
							"userPhone" : userPhone,
							"desc" : desc,
							"filteType" : filteType
						},
						success : function(data) {
							if (data == "success") {
								parent.hideMenu();
								parent.closeTypelayer();
							} else {
								alert("操作失败");
							}
						}
					});
				}
			});
});
	alert("加载成功");
	$("#submitbutton").bind(
			'click',
			function() {
				var userIdIsNull= $("#userIdIsNull").val();
				alert(userIdIsNull);
				var userPhone = $("#userPhone").val();
				var desc = $("#desc").val();
				var filteType = $("#filteType").val();
				var phoneNum = /^1[3|4|5|7|8]\d{9}$/;
				if (!phoneNum.test(userPhone)) {
					alert("请输入正确的手机号");
					return false;

/*
 * 
 * $("#userPhone").on('blur',function() { var userPhone = $('#userPhone').val();
 * $.post("activity-filte!isduplicate", {'bo.userPhone':userPhone},
 * function(data) { if(data.isConflict=="1") {
 * $.epm.snackbar("手机号码已经存在名单中，请检查"); //$('#userPhone').val("");
 * 
 * return; } }); });
 */

/*

 * $("#cancelbutton").on('click', function(){ if(confirm("取消后填写信息丢失，确认放弃？")) if
 * ($("#isAddChild").val() == "1"||$("#isSubActivity").val() == "1") {
 * window.close(); }else{ history.back(); } // cancelSaveActivity(); });
 */


$("#userPhone").on('blur',function() {
	var userPhone = $('#userPhone').val();
	$.post("activity-filte!isduplicate",
			{'bo.userPhone':userPhone},
			function(data) {
					if(data.isConflict=="1") {
						$.epm.snackbar("手机号码已经存在名单中,请检查");
						//$('#userPhone').val("");
						
						return;
					}
			});
});*/


/*$("#cancelbutton").on('click', function(){
	if(confirm("取消后填写信息丢失,确认放弃？")) 
	if ($("#isAddChild").val() == "1"||$("#isSubActivity").val() == "1") {
		window.close();
	}else{
		history.back();
	}
//	cancelSaveActivity();
});*/
function yyf(){
$("#submitbutton").bind('click', function yyf(){
	var userPhone = $('#userPhone').val();
	var desc = $('#desc').val();
	var filteType = $("#filteType").val();
	//1(3[4-9]|4[7]|5[0-27-9]|7[08]|8[2-478])\\d{8}$
	//^1[3|4|5|7|8]\d{9}$
	var phoneNum =/^1[3|4|5|7|8]\d{9}$/;
	if(!phoneNum.test(userPhone) ) {
		alert("请输入正确的手机号");
		
	}
	if(desc==null || desc.length==0 || desc=="") {
		alert("请输入描述信息");
		
	}
	/*if(filteType!="黑名单" && filteType!="白名单") {
		alert("请选择用户类型");
		
	}*/
		if (!confirm('确认提交？'))
		
			var userId = $("#userId").val();
			var logUserPhone = $('#logUserPhone').val();
			var logDesc = $('#logDesc').val();
			var logFilteType = $('#logFilteType').val();
			var logOperator = $('#logOperator').val();
			var logOperateTime = $('#logOperateTime').val();
			if(userId!=null && userId.length!=0) {
				var str = "activity-filte!modify?bo.userId="+userId+"&bo.userPhone="+userPhone+"&bo.desc="+desc+"&bo.filteType="+filteType
										+"&logBo.userPhone="+logUserPhone+","+logOperateTime+"&logBo.desc="+logDesc+"&logBo.filteType="+logFilteType+"&logBo.operator="+logOperator;
				action="../filte/toModify";
				$.ajax({
					url : action,
					type : "POST",
					async : true,
					data : {
						"userId" : userId,
					    "userPhone":userPhone,
					    "filteType":filteType,
					    "logOperateTime":logOperateTime,
					    "logDesc":logDesc,
					    "logOperator":logOperator
					},
					success : function(data) {
						if (data == "success") {
							parent.hideMenu();
							parent.closeTypelayer();
						} else {
							alert("操作失败");
						}
					}
				});
			}else{
				action="../filte/add";
				}
				if (desc == null || desc.length == 0 || desc == "") {
					alert("请输入描述信息");
					return false;
				}
				if (confirm('确认提交？')) {
					
					if (userIdIsNull != null && userIdIsNull.length != 0) {
						action = "../filte/modify";
						$.ajax({
							url : action,
							type : "POST",
							async : true,
							data : {
								"userId" : userIdIsNull,
								"userPhone" : userPhone,
								"filteType" : filteType,
								"desc" : desc,
							},
							success : function(data) {
								if (data == "success") {
									alert("操作成功");
									parent.hideMenu();
									parent.closeTypelayer();
								} else {
									alert("操作失败");
								}
							}
						});
					} else {
				action = "../filte/add";
				$.ajax({
					url : action,
					type : "POST",
					async : true,
					data : {
						"userPhone" : userPhone,
						"desc" : desc,
						"filteType" : filteType
					},
					success : function(data) {
						if (data == "success") {
							alert("添加成功");
							parent.hideMenu();
							parent.closeTypelayer();
						} else {
							alert("操作失败");
						}
					}
				});
			}
				}

			});
});

//});}

/*
 * 
 * $("#userPhone").on('blur',function() { var userPhone = $('#userPhone').val();
 * $.post("activity-filte!isduplicate", {'bo.userPhone':userPhone},
 * function(data) { if(data.isConflict=="1") {
 * $.epm.snackbar("手机号码已经存在名单中，请检查"); //$('#userPhone').val("");
 * 
 * return; } }); });
 */

/*
 * $("#cancelbutton").on('click', function(){ if(confirm("取消后填写信息丢失，确认放弃？")) if
 * ($("#isAddChild").val() == "1"||$("#isSubActivity").val() == "1") {
 * window.close(); }else{ history.back(); } // cancelSaveActivity(); });
 */
